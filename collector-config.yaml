receivers:
  filelog/apache:
    include: [ "./apache.log" ]
    start_at: beginning

  filelog/syslog:
    include: [ "./syslog.log" ]
    start_at: beginning

  filelog/asa:
    include: [ "./asa.log" ]
    start_at: beginning
  filelog/cisco_ise:
    include: [ "./cisco_ise.log" ]
    start_at: beginning

    filelog/cisco_ios:
      include: [ "./cisco_ios.log" ]
      start_at: beginning
processors:
  # For Apache logs (combined log format)
  apache_grok:
    pattern: "%{COMBINEDAPACHELOG}"
    pattern_directory: ./patterns

  # For Syslog messages
  syslog_grok:
    pattern: "%{SYSLOGBASE}"
    pattern_directory: ./patterns

  # For your ASA302014 pattern with field map and extract_cef
  grokproc:
    pattern: "%{ASA302014}"
    pattern_directory: ./patterns
    field_map:
      src: "source.ip"
      dst: "destination.ip"
    extract_cef: true
  cisco_ise_grok:
    # Choose the most specific match for your Cisco ISE logs,
    # or switch between CISCO_ISE_SYSLOG_1..5 based on your device's format.
    pattern: "%{CISCO_ISE_SYSLOG_1}"
    pattern_directory: ./patterns

    cisco_ios_grok:
      # Pick the pattern that matches your Cisco IOS logs;
      # alternatives: CISCO_IOS_SYSLOG1, CISCO_IOS_SYSLOG2, etc.
      pattern: "%{CISCO_IOS_SYSLOG1}"
      pattern_directory: ./patterns
exporters:
  logging:
    loglevel: debug

service:
  pipelines:
    logs/apache:
      receivers: [filelog/apache]
      processors: [apache_grok]
      exporters: [logging]

    logs/syslog:
      receivers: [filelog/syslog]
      processors: [syslog_grok]
      exporters: [logging]

    logs/asa:
      receivers: [filelog/asa]
      processors: [grokproc]
      exporters: [logging]

    logs/cisco_ise:
      receivers: [ filelog/cisco_ise ]
      processors: [ cisco_ise_grok ]
      exporters: [ logging ]

    logs/cisco_ios:
        receivers: [ filelog/cisco_ios ]
        processors: [ cisco_ios_grok ]
        exporters: [ logging ]
